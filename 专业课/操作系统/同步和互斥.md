# 同步和互斥

## 同步与互斥的基本概念

### 临界资源

同时只能有一个进程进行访问

### 同步

表现为一种协作的关系。有一定的工作次序

### 互斥

是一种制约的关系。A访问B就不能访问

## 进程互斥的软件实现方法

### 为什么要进行互斥访问？

比如说A在使用打印机，A打到一般就被叫停了。这时B进行打印，这样打印的内容就混掉了。因此我们必须保证A能一口气打印完。

### 单标志法

**使用一个turn表示当前允许哪个进程访问临界区**

在退出区把使用权转让给别人。但是如果别人一直不使用，自己也没法使用。违反了（空闲让进）的原则。

### 双标志先检查

用flag表示是否想要访问临界区。

进入临界区的条件是对方不想进入临界区。

如果自己进入了临界区，就把自己的flag设置为true。退出就设为false。

**但是并发运行时会出现问题。违反了忙则等待的原因。（检查和上锁的过程不能一气呵成）**

### 双标志后检查

先上锁表示自己想访问临界区。在查看对方是否在访问临界区。

但是会出现双方都在等待的情况，出现饥饿。违背了“空闲让进“的原则

### Peterson算法

单标志法和双标志法相结合。

+ 先表达自己想要使用资源
+ 再表示自己愿意谦让给对方
+ 如果是对方想用，且最后是自己表达了谦让。就一直等待。

这里可以与现实生活联系起来。

## 进程互斥的硬件实现方法

### 中断屏蔽方法

+ 使用开关中断指令进行实现。

+ 关中断之后就无法进行进程切换，就会一直享有该资源。
  + 但是多处理机情况下不能实现

### TSL指令

是由硬件实现的

检查和上锁是一气呵成的。（解决了双标志法的异步问题）

适用于多处理机

### SWAP指令

和tsl差不多